/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package view;

import bean.AuditoriaSistema;
import bean.Caja;
import bean.CuentaBancaria;
import bean.ExtraccionDeposito;
import bean.FacturaCobro;
import java.awt.PageAttributes;
import java.text.DateFormat;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Iterator;
import java.util.List;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.Query;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import view.LoginView;
import bean.DetalleCobro;
import bean.FacturaCobro;
import java.awt.Image;
import java.sql.Connection;
import java.sql.DriverManager;
import java.util.HashMap;
import java.util.Map;
import javax.swing.ImageIcon;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.view.JasperViewer;

/**
 *
 * @author tammy
 */
public class ArquearCaja extends javax.swing.JFrame {
public int montoEfectivo=0;
public int montoTarjetaCredito=0;
public int montoTarjetaDebito=0;
public int montoCheque=0;
public int montoTotal=0;
//public int montoInicial=0;
private int resp,resp1;
public static int op;
public static int cuentaBancaria;
    /**
     * Creates new form ArquearCaja
     */
    public ArquearCaja() {
        initComponents();
        obtenerCaja();
        tf_montoCheque.setText("0");
        tf_montoEfectivo.setText("0");
        tf_montoTarjetaDebito.setText("0");
        tf_montoTotal.setText("0");
        tf_montoTarjetaCredito.setText("0");
      //  tabla.setVisible(false);
        
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        entityManager = java.beans.Beans.isDesignTime() ? null : javax.persistence.Persistence.createEntityManagerFactory("proyectoPU").createEntityManager();
        query = java.beans.Beans.isDesignTime() ? null : entityManager.createQuery("SELECT c FROM Caja c");
        list = java.beans.Beans.isDesignTime() ? java.util.Collections.emptyList() : query.getResultList();
        cuentaBancariaQuery = java.beans.Beans.isDesignTime() ? null : entityManager.createQuery("SELECT c FROM CuentaBancaria c");
        cuentaBancariaList = java.beans.Beans.isDesignTime() ? java.util.Collections.emptyList() : cuentaBancariaQuery.getResultList();
        facturaCobroQuery = java.beans.Beans.isDesignTime() ? null : entityManager.createQuery("SELECT f FROM FacturaCobro f");
        facturaCobroList = java.beans.Beans.isDesignTime() ? java.util.Collections.emptyList() : org.jdesktop.observablecollections.ObservableCollections.observableList(facturaCobroQuery.getResultList());
        jPanel3 = new javax.swing.JPanel();
        lbl_registrarC = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        lbl_nombre = new javax.swing.JLabel();
        cantidadMinimaLabel = new javax.swing.JLabel();
        tf_caja = new javax.swing.JTextField();
        tf_montoInicial = new javax.swing.JTextField();
        jPanel2 = new javax.swing.JPanel();
        cantidadMinimaLabel2 = new javax.swing.JLabel();
        cantidadMinimaLabel3 = new javax.swing.JLabel();
        cantidadMinimaLabel4 = new javax.swing.JLabel();
        tf_montoEfectivo = new javax.swing.JTextField();
        tf_montoTarjetaDebito = new javax.swing.JTextField();
        tf_montoCheque = new javax.swing.JTextField();
        cantidadMinimaLabel5 = new javax.swing.JLabel();
        tf_montoTotal = new javax.swing.JTextField();
        btn_detalleTarjetaDebito = new javax.swing.JButton();
        btn_detalleCheque = new javax.swing.JButton();
        tf_montoTarjetaCredito = new javax.swing.JTextField();
        btn_detalleTarjetaCredito = new javax.swing.JButton();
        cantidadMinimaLabel6 = new javax.swing.JLabel();
        lbl_nombre1 = new javax.swing.JLabel();
        tf_fechaCierre = new javax.swing.JTextField();
        lbl_nombre2 = new javax.swing.JLabel();
        tf_fechaApertura = new javax.swing.JTextField();
        btn_calcular = new javax.swing.JButton();
        jPanel6 = new javax.swing.JPanel();
        btn_cancelar3 = new javax.swing.JButton();
        btn_guardar3 = new javax.swing.JButton();
        btn_informe = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jPanel3.setBackground(new java.awt.Color(0, 153, 255));
        jPanel3.setBorder(javax.swing.BorderFactory.createEtchedBorder(javax.swing.border.EtchedBorder.RAISED));

        lbl_registrarC.setFont(new java.awt.Font("Corbel", 1, 30)); // NOI18N
        lbl_registrarC.setForeground(new java.awt.Color(255, 255, 255));
        lbl_registrarC.setText("Arqueo Caja");

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addGap(207, 207, 207)
                .addComponent(lbl_registrarC)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addComponent(lbl_registrarC)
                .addGap(0, 10, Short.MAX_VALUE))
        );

        jPanel1.setBackground(new java.awt.Color(204, 204, 204));
        jPanel1.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        jPanel1.setForeground(new java.awt.Color(0, 153, 255));

        lbl_nombre.setFont(new java.awt.Font("Candara", 0, 14)); // NOI18N
        lbl_nombre.setText("Fecha/Hora Cierre:");

        cantidadMinimaLabel.setFont(new java.awt.Font("Candara", 0, 14)); // NOI18N
        cantidadMinimaLabel.setText("Monto Inicial en Caja: ");

        tf_caja.setEnabled(false);
        tf_caja.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tf_cajaActionPerformed(evt);
            }
        });
        tf_caja.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                tf_cajaKeyTyped(evt);
            }
        });

        tf_montoInicial.setEnabled(false);
        tf_montoInicial.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                tf_montoInicialKeyTyped(evt);
            }
        });

        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Monto Generado", javax.swing.border.TitledBorder.CENTER, javax.swing.border.TitledBorder.DEFAULT_POSITION));

        cantidadMinimaLabel2.setFont(new java.awt.Font("Candara", 0, 14)); // NOI18N
        cantidadMinimaLabel2.setText("Monto Efectivo: ");

        cantidadMinimaLabel3.setFont(new java.awt.Font("Candara", 0, 14)); // NOI18N
        cantidadMinimaLabel3.setText("Monto Tarjeta Credito: ");

        cantidadMinimaLabel4.setFont(new java.awt.Font("Candara", 0, 14)); // NOI18N
        cantidadMinimaLabel4.setText("Monto Cheque: ");

        tf_montoEfectivo.setEnabled(false);
        tf_montoEfectivo.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                tf_montoEfectivoActionPerformed(evt);
            }
        });
        tf_montoEfectivo.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                tf_montoEfectivoKeyTyped(evt);
            }
        });

        tf_montoTarjetaDebito.setEnabled(false);
        tf_montoTarjetaDebito.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                tf_montoTarjetaDebitoKeyTyped(evt);
            }
        });

        tf_montoCheque.setEnabled(false);

        cantidadMinimaLabel5.setFont(new java.awt.Font("Candara", 0, 14)); // NOI18N
        cantidadMinimaLabel5.setText("Monto Total: ");

        tf_montoTotal.setEnabled(false);

        btn_detalleTarjetaDebito.setText("Ver Detalle");
        btn_detalleTarjetaDebito.setEnabled(false);
        btn_detalleTarjetaDebito.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_detalleTarjetaDebitoActionPerformed(evt);
            }
        });

        btn_detalleCheque.setText("Ver Detalle");
        btn_detalleCheque.setEnabled(false);
        btn_detalleCheque.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_detalleChequeActionPerformed(evt);
            }
        });

        tf_montoTarjetaCredito.setEnabled(false);
        tf_montoTarjetaCredito.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                tf_montoTarjetaCreditoKeyTyped(evt);
            }
        });

        btn_detalleTarjetaCredito.setText("Ver Detalle");
        btn_detalleTarjetaCredito.setEnabled(false);
        btn_detalleTarjetaCredito.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_detalleTarjetaCreditoActionPerformed(evt);
            }
        });

        cantidadMinimaLabel6.setFont(new java.awt.Font("Candara", 0, 14)); // NOI18N
        cantidadMinimaLabel6.setText("Monto Tarjeta Debito: ");

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(224, 224, 224)
                        .addComponent(tf_montoTotal))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGap(115, 115, 115)
                                .addComponent(cantidadMinimaLabel5))
                            .addComponent(cantidadMinimaLabel3))
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(cantidadMinimaLabel4)
                            .addComponent(cantidadMinimaLabel6)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addContainerGap()
                                .addComponent(cantidadMinimaLabel2)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addComponent(tf_montoCheque, javax.swing.GroupLayout.PREFERRED_SIZE, 144, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(18, 18, 18)
                                .addComponent(btn_detalleCheque))
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                    .addComponent(tf_montoEfectivo, javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(tf_montoTarjetaCredito)
                                    .addComponent(tf_montoTarjetaDebito, javax.swing.GroupLayout.DEFAULT_SIZE, 142, Short.MAX_VALUE))
                                .addGap(18, 18, 18)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addComponent(btn_detalleTarjetaDebito, javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addComponent(btn_detalleTarjetaCredito, javax.swing.GroupLayout.Alignment.TRAILING))))
                        .addGap(19, 19, 19)))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap(26, Short.MAX_VALUE)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(tf_montoEfectivo, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cantidadMinimaLabel2))
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(cantidadMinimaLabel3, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(btn_detalleTarjetaCredito)
                        .addComponent(tf_montoTarjetaCredito, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(tf_montoTarjetaDebito, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btn_detalleTarjetaDebito)
                    .addComponent(cantidadMinimaLabel6))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btn_detalleCheque)
                    .addComponent(tf_montoCheque, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cantidadMinimaLabel4))
                .addGap(18, 18, 18)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(tf_montoTotal, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(cantidadMinimaLabel5))
                .addContainerGap())
        );

        lbl_nombre1.setFont(new java.awt.Font("Candara", 0, 14)); // NOI18N
        lbl_nombre1.setText("Fecha/Hora Apertura:");

        tf_fechaCierre.setEnabled(false);
        tf_fechaCierre.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                tf_fechaCierreKeyTyped(evt);
            }
        });

        lbl_nombre2.setFont(new java.awt.Font("Candara", 0, 14)); // NOI18N
        lbl_nombre2.setText("Caja:");

        tf_fechaApertura.setEnabled(false);
        tf_fechaApertura.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                tf_fechaAperturaKeyTyped(evt);
            }
        });

        btn_calcular.setText("Calcular");
        btn_calcular.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_calcularActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(lbl_nombre1, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(cantidadMinimaLabel, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(lbl_nombre, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                        .addGap(32, 32, 32)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(tf_fechaCierre, javax.swing.GroupLayout.PREFERRED_SIZE, 180, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(tf_fechaApertura, javax.swing.GroupLayout.PREFERRED_SIZE, 180, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addGroup(jPanel1Layout.createSequentialGroup()
                                .addComponent(tf_montoInicial, javax.swing.GroupLayout.PREFERRED_SIZE, 180, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(btn_calcular))))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addComponent(lbl_nombre2, javax.swing.GroupLayout.PREFERRED_SIZE, 145, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(tf_caja, javax.swing.GroupLayout.PREFERRED_SIZE, 180, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(27, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbl_nombre2)
                    .addComponent(tf_caja, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbl_nombre1)
                    .addComponent(tf_fechaApertura, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbl_nombre)
                    .addComponent(tf_fechaCierre, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(cantidadMinimaLabel, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(tf_montoInicial, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(0, 19, Short.MAX_VALUE)
                        .addComponent(btn_calcular)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jPanel2, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(20, 20, 20))
        );

        jPanel6.setBackground(new java.awt.Color(204, 204, 204));
        jPanel6.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        btn_cancelar3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/delete.png"))); // NOI18N
        btn_cancelar3.setText("Cancelar");
        btn_cancelar3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_cancelar3ActionPerformed(evt);
            }
        });

        btn_guardar3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagenes/guardar.png"))); // NOI18N
        btn_guardar3.setText("Aceptar");
        btn_guardar3.setEnabled(false);
        btn_guardar3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_guardar3ActionPerformed(evt);
            }
        });

        btn_informe.setText("Informe");
        btn_informe.setEnabled(false);
        btn_informe.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_informeActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addGap(34, 34, 34)
                .addComponent(btn_guardar3)
                .addGap(36, 36, 36)
                .addComponent(btn_informe)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 40, Short.MAX_VALUE)
                .addComponent(btn_cancelar3)
                .addGap(34, 34, 34))
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(btn_cancelar3)
                    .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(btn_guardar3)
                        .addComponent(btn_informe)))
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
            .addGroup(layout.createSequentialGroup()
                .addGap(62, 62, 62)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(64, Short.MAX_VALUE))
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(101, 101, 101))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jPanel6, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void tf_cajaKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tf_cajaKeyTyped
        // TODO add your handling code here:

    }//GEN-LAST:event_tf_cajaKeyTyped

    private void tf_montoInicialKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tf_montoInicialKeyTyped
        // TODO add your handling code here:
      
    }//GEN-LAST:event_tf_montoInicialKeyTyped

    private void btn_cancelar3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_cancelar3ActionPerformed
        // TODO add your handling code here:
        this.setVisible(false);
        String[] args = null;
                    MenuSupervisorCaja.main(args);
            
    }//GEN-LAST:event_btn_cancelar3ActionPerformed

    private void btn_guardar3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_guardar3ActionPerformed
        int id= Integer.parseInt(tf_caja.getText());
         resp=  JOptionPane.showConfirmDialog(null,"Desea registrar el arqueo?", "Confirmar Arqueo",JOptionPane.YES_NO_OPTION );
            if (resp==JOptionPane.YES_OPTION){
                query= entityManager.createNamedQuery("Caja.findByCodigoCaja");
                query.setParameter("codigoCaja", id);
                Caja c1= new Caja();
                c1.setCodigoCaja(Integer.parseInt(tf_caja.getText()));
                c1.setEstado('D');
                c1.setFechaHora(tf_fechaCierre.getText());
                c1.setMontoFinal(Integer.parseInt(tf_montoTotal.getText()));
                c1.setMontoInicial(Integer.parseInt(tf_montoInicial.getText()));
                  entityManager.getTransaction().begin();
                  entityManager.merge(c1);
                  entityManager.flush();
               // Buscar Cuenta Bancaria
                  buscarCuentaBancaria();
                 
                  //Crear Extraccrion
                  ExtraccionDeposito deposito= new ExtraccionDeposito();
                  deposito.setFecha(tf_fechaCierre.getText());
                  deposito.setMonto(Integer.parseInt(tf_montoTotal.getText()));
                  deposito.setTipo("D");
                  CuentaBancaria cb =  obtenerCuenta(cuentaBancaria);
                  deposito.setIdCuentaBancaria(cb);
                 // deposito.setIdPagoCobro(Integer.parseInt(tf_caja.getText()));
              //     entityManager.getTransaction().begin();
                   entityManager.persist(deposito);
                   entityManager.flush();
           
                  
                           AuditoriaSistema as=new AuditoriaSistema();
                    as.setAccion("Registrar");
                    as.setTabla("Arqueo Caja");
                    as.setAntes(c1.toString());
                    as.setDespues("No hay cambios");
                    //trabajamos con la fecha
                    Date fecha=new Date();
                    DateFormat formato=new SimpleDateFormat("dd-MM-yyyy HH:mm:ss");
                    as.setFechaHora((formato.format(fecha)));
                    as.setUsuario(LoginView.nombreUsuario);
                    entityManager.persist(as);
                    entityManager.getTransaction().commit();
                    entityManager.close();
                    JOptionPane.showMessageDialog(null,"Arqueo Exitoso", "Confirmación",JOptionPane.INFORMATION_MESSAGE);
                    resp1=  JOptionPane.showConfirmDialog(null,"Desea imprimir?", "Confirmar Impresión",JOptionPane.YES_NO_OPTION );
                        if (resp1==JOptionPane.YES_OPTION){
                            imprimir();
                        }
            }
            vaciar();
           this.dispose();  
    }//GEN-LAST:event_btn_guardar3ActionPerformed

    private void tf_montoEfectivoKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tf_montoEfectivoKeyTyped
        // TODO add your handling code here:
    }//GEN-LAST:event_tf_montoEfectivoKeyTyped

    private void tf_montoTarjetaDebitoKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tf_montoTarjetaDebitoKeyTyped
        // TODO add your handling code here:
    }//GEN-LAST:event_tf_montoTarjetaDebitoKeyTyped

    private void tf_fechaCierreKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tf_fechaCierreKeyTyped
        // TODO add your handling code here:
    }//GEN-LAST:event_tf_fechaCierreKeyTyped

    private void tf_fechaAperturaKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tf_fechaAperturaKeyTyped
        // TODO add your handling code here:
    }//GEN-LAST:event_tf_fechaAperturaKeyTyped

    private void btn_calcularActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_calcularActionPerformed
        // TODO add your handling code here:
        btn_guardar3.setEnabled(true);
        btn_informe.setEnabled(true);
        String d1 = tf_fechaApertura.getText();
        String d2 = tf_fechaCierre.getText();
     /*   DateFormat format = new SimpleDateFormat("dd-MM-yyyy HH:mm:ss");
                     String d1 = tf_fechaApertura.getText();
                     String d2 = tf_fechaCierre.getText();
                     Date apert = null;
                     Date cierre = null;
                     try {
                         apert = format.parse(d1);
                         cierre = format.parse(d2);
                    
                       
                     } catch (ParseException ex) {
                         System.out.println("Formateo de fechas fallido");
                     }*/
       System.out.print(d1+"  "+d2);
       obtenerMontoContado(d1, d2);
      obtenerMontoTarjetaCredito(d1, d2);
       obtenerMontoCheque(d1, d2);
       obtenerMontoTarjetaDebito(d1, d2);
     
       //sumar monto inicial efectivo
     
       montoEfectivo= montoEfectivo+Integer.parseInt(tf_montoInicial.getText());
       tf_montoEfectivo.setText(String.valueOf(montoEfectivo));
       montoTotal = montoEfectivo+montoCheque+montoTarjetaCredito+montoTarjetaDebito;
       tf_montoTotal.setText(String.valueOf(montoTotal));
     //  llenarTabla(d1,d2);
      // vaciar();
    }//GEN-LAST:event_btn_calcularActionPerformed

    private void btn_detalleTarjetaDebitoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_detalleTarjetaDebitoActionPerformed
        new DetallePagoTarjetaDebito(this, true).setVisible(true);
        

    }//GEN-LAST:event_btn_detalleTarjetaDebitoActionPerformed

    private void tf_cajaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tf_cajaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_tf_cajaActionPerformed

    private void btn_detalleChequeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_detalleChequeActionPerformed
        // TODO add your handling code here:
           new  DetallePagoCheque(this, true).setVisible(true);
    }//GEN-LAST:event_btn_detalleChequeActionPerformed

    private void tf_montoTarjetaCreditoKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_tf_montoTarjetaCreditoKeyTyped
        // TODO add your handling code here:
        
    }//GEN-LAST:event_tf_montoTarjetaCreditoKeyTyped

    private void btn_detalleTarjetaCreditoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_detalleTarjetaCreditoActionPerformed
        // TODO add your handling code here:
      //  this.setVisible(false);
        new DetallePagoTarjetaCredito(this, true).setVisible(true);
      //  this.setVisible(true);
    }//GEN-LAST:event_btn_detalleTarjetaCreditoActionPerformed

    private void tf_montoEfectivoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_tf_montoEfectivoActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_tf_montoEfectivoActionPerformed

    private void btn_informeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_informeActionPerformed
        imprimir();
    }//GEN-LAST:event_btn_informeActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(ArquearCaja.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(ArquearCaja.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(ArquearCaja.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(ArquearCaja.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                JFrame frame=new ArquearCaja();
                frame.setVisible(true);
                frame.setLocationRelativeTo(null);
                frame.setTitle("Arqueo Caja");
                  frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
                
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btn_calcular;
    private javax.swing.JButton btn_cancelar3;
    private javax.swing.JButton btn_detalleCheque;
    private javax.swing.JButton btn_detalleTarjetaCredito;
    private javax.swing.JButton btn_detalleTarjetaDebito;
    private javax.swing.JButton btn_guardar3;
    private javax.swing.JButton btn_informe;
    private javax.swing.JLabel cantidadMinimaLabel;
    private javax.swing.JLabel cantidadMinimaLabel2;
    private javax.swing.JLabel cantidadMinimaLabel3;
    private javax.swing.JLabel cantidadMinimaLabel4;
    private javax.swing.JLabel cantidadMinimaLabel5;
    private javax.swing.JLabel cantidadMinimaLabel6;
    private java.util.List<bean.CuentaBancaria> cuentaBancariaList;
    private javax.persistence.Query cuentaBancariaQuery;
    private javax.persistence.EntityManager entityManager;
    private java.util.List<bean.FacturaCobro> facturaCobroList;
    private javax.persistence.Query facturaCobroQuery;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JLabel lbl_nombre;
    private javax.swing.JLabel lbl_nombre1;
    private javax.swing.JLabel lbl_nombre2;
    private javax.swing.JLabel lbl_registrarC;
    private java.util.List<bean.Caja> list;
    private javax.persistence.Query query;
    public javax.swing.JTextField tf_caja;
    public static javax.swing.JTextField tf_fechaApertura;
    public static javax.swing.JTextField tf_fechaCierre;
    private javax.swing.JTextField tf_montoCheque;
    private javax.swing.JTextField tf_montoEfectivo;
    private javax.swing.JTextField tf_montoInicial;
    private javax.swing.JTextField tf_montoTarjetaCredito;
    private javax.swing.JTextField tf_montoTarjetaDebito;
    private javax.swing.JTextField tf_montoTotal;
    // End of variables declaration//GEN-END:variables

   

    private void obtenerCaja() {
        query = entityManager.createNamedQuery("Caja.findByEstado");
                query.setParameter("estado",'H');
                List<Caja> cj = query.getResultList();
                if (cj.isEmpty()){
                    JOptionPane.showMessageDialog(null, "No se dio Apertura a Caja","Error",JOptionPane.ERROR_MESSAGE );
                   vaciar();            //  this.dispose();
                    
                 //   this.setVisible(false);
                }
                else{
                    Caja ci = obtenerValores('H');
                    tf_caja.setText(ci.getCodigoCaja().toString());
                    tf_fechaApertura.setText(ci.getFechaHora().toString());
                    tf_montoInicial.setText(String.valueOf(ci.getMontoInicial()));
                    Date fecha=new Date();
                    DateFormat formato=new SimpleDateFormat("dd/MM/yyyy HH:mm:ss");
                    tf_fechaCierre.setText(formato.format(fecha));
        
    }}
     private Caja obtenerValores(char valor){
        Caja caja ;
        EntityManagerFactory fact = Persistence.createEntityManagerFactory("proyectoPU");
        EntityManager ema = fact.createEntityManager();
        ema.getTransaction().begin();
        Query query = ema.createNamedQuery("Caja.findByEstado");
        query.setParameter("estado", valor);
        List<Caja> cja = query.getResultList();
        try{
            caja = cja.get(0);  
        }catch(ArrayIndexOutOfBoundsException e){
            caja = null;
        }
        
        ema.close();
        return caja;
    }

    private void obtenerMontoContado(String f1, String f2) {
        facturaCobroQuery=entityManager.createNativeQuery("SELECT *"+
                        "FROM factura_cobro fc "+
                      //  "JOIN detalle_cobro dc "+
                       // "on dc.idDetalle=fc.forma_pago "+
                        "WHERE fc.tipoFactura='Contado' "+
                        "AND STR_TO_DATE(fechaEmision , '%d/%m/%Y %H :%i :%s') "+
                        "BETWEEN STR_TO_DATE('"+f1+"', '%d/%m/%Y %H :%i :%s') "+
                        "AND STR_TO_DATE('"+f2+"', '%d/%m/%Y %H :%i :%s') "
         );
         List<FacturaCobro> p=facturaCobroQuery.getResultList();
        if (p.isEmpty()){
             montoEfectivo=0;
//             btn_detalleContado.setEnabled(false);
           // tf_montoEfectivo.setText(String.valueOf(montoEfectivo));
        }
        else{
        
    //    btn_detalleContado.setEnabled(true);
         facturaCobroQuery=entityManager.createNativeQuery("SELECT sum(fc.total)"+
                        "FROM factura_cobro fc "+
                      //  "JOIN detalle_cobro dc "+
                       // "on dc.idDetalle=fc.forma_pago "+
                        "WHERE fc.tipoFactura='Contado' "+
                        "AND STR_TO_DATE(fechaEmision , '%d/%m/%Y %H :%i :%s') "+
                        "BETWEEN STR_TO_DATE('"+f1+"', '%d/%m/%Y %H :%i :%s') "+
                        "AND STR_TO_DATE('"+f2+"', '%d/%m/%Y %H :%i :%s') "
         );
         
                         Object resultado=facturaCobroQuery.getSingleResult();
                         montoEfectivo=Integer.parseInt(resultado.toString());
                      //   tf_montoEfectivo.setText(String.valueOf(montoEfectivo));
   }}

    

    private void obtenerMontoTarjetaCredito(String f1, String f2) {
      //  throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
        facturaCobroQuery=entityManager.createNativeQuery("SELECT * "+
                        "FROM factura_cobro fc "+
                        "JOIN detalle_cobro dc "+
                        "on dc.idDetalle=fc.forma_pago " +
                        "WHERE fc.tipoFactura='Crédito' "+
                        "and dc.forma='TarjetaCredito' "+
                        "AND STR_TO_DATE(fechaEmision , '%d/%m/%Y %H :%i :%s') "+
                        "BETWEEN STR_TO_DATE('"+f1+"', '%d/%m/%Y %H :%i :%s') "+
                        "AND STR_TO_DATE('"+f2+"', '%d/%m/%Y %H :%i :%s') "//+
                      //  " GROUP BY dc.entidad"
          ); 
          List<FacturaCobro> p=facturaCobroQuery.getResultList();
        if (p.isEmpty()){
            btn_detalleTarjetaCredito.setEnabled(false);
             montoTarjetaCredito=0;
            tf_montoTarjetaCredito.setText(String.valueOf(montoTarjetaCredito));
        }
        else{
        btn_detalleTarjetaCredito.setEnabled(true);
        facturaCobroQuery=entityManager.createNativeQuery("SELECT sum(fc.total)"+
                        "FROM factura_cobro fc "+
                        "JOIN detalle_cobro dc "+
                        "on dc.idDetalle=fc.forma_pago "+
                        "WHERE fc.tipoFactura='Crédito' "+
                        "and dc.forma='TarjetaCredito' "+
                        "AND STR_TO_DATE(fechaEmision , '%d/%m/%Y %H :%i :%s') "+
                        "BETWEEN STR_TO_DATE('"+f1+"', '%d/%m/%Y %H :%i :%s') "+
                        "AND STR_TO_DATE('"+f2+"', '%d/%m/%Y %H :%i :%s') "//+
                      //  " GROUP BY dc.entidad"
          );
                         Object resultado1=facturaCobroQuery.getSingleResult();
                         montoTarjetaCredito=Integer.parseInt(resultado1.toString());
                         tf_montoTarjetaCredito.setText(String.valueOf(montoTarjetaCredito));
    }}
    private void obtenerMontoTarjetaDebito(String f1, String f2) {
      //  throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
        facturaCobroQuery=entityManager.createNativeQuery("SELECT * "+
                        "FROM factura_cobro fc "+
                        "JOIN detalle_cobro dc "+
                        "on dc.idDetalle=fc.forma_pago "+
                        "WHERE fc.tipoFactura='Crédito' "+
                        "and dc.forma='TarjetaDebito' "+
                        "AND STR_TO_DATE(fechaEmision , '%d/%m/%Y %H :%i :%s') "+
                        "BETWEEN STR_TO_DATE('"+f1+"', '%d/%m/%Y %H :%i :%s') "+
                        "AND STR_TO_DATE('"+f2+"', '%d/%m/%Y %H :%i :%s') "//+
                    //    " GROUP BY dc.entidad"
                  );  
          List<FacturaCobro> p=facturaCobroQuery.getResultList();
         if (p.isEmpty()){
             btn_detalleTarjetaDebito.setEnabled(false);
             montoTarjetaDebito=0;
            tf_montoTarjetaDebito.setText(String.valueOf(montoTarjetaDebito));
           
        }
        else{
             btn_detalleTarjetaDebito.setEnabled(true);
        facturaCobroQuery=entityManager.createNativeQuery("SELECT sum(fc.total)"+
                        "FROM factura_cobro fc "+
                        "JOIN detalle_cobro dc "+
                        "on dc.idDetalle=fc.forma_pago "+
                        "WHERE fc.tipoFactura='Crédito' "+
                        "and dc.forma='TarjetaDebito' "+
                        "AND STR_TO_DATE(fechaEmision , '%d/%m/%Y %H :%i :%s') "+
                        "BETWEEN STR_TO_DATE('"+f1+"', '%d/%m/%Y %H :%i :%s') "+
                        "AND STR_TO_DATE('"+f2+"', '%d/%m/%Y %H :%i :%s') "//+
                    //    " GROUP BY dc.entidad"
                  );
                         Object resultado=facturaCobroQuery.getSingleResult();
                         montoTarjetaDebito=Integer.parseInt(resultado.toString());
                          tf_montoTarjetaDebito.setText(String.valueOf(montoTarjetaDebito));
    }}



     private void obtenerMontoCheque(String f1, String f2) {
      //  throw new UnsupportedOperationException("Not supported yet."); //To change body of generated methods, choose Tools | Templates.
         facturaCobroQuery=entityManager.createNativeQuery("SELECT * "+
                        "FROM factura_cobro fc "+
                        "JOIN detalle_cobro dc "+
                        "on dc.idDetalle=fc.forma_pago "+
                        "WHERE fc.tipoFactura='Crédito' "+
                        "and dc.forma='Cheque' "+
                        "AND STR_TO_DATE(fechaEmision , '%d/%m/%Y %H :%i :%s') "+
                        "BETWEEN STR_TO_DATE('"+f1+"', '%d/%m/%Y %H :%i :%s') "+
                        "AND STR_TO_DATE('"+f2+"', '%d/%m/%Y %H :%i :%s') "//+
                        //" GROUP BY dc.entidad"
                  ); 
           List<FacturaCobro> p=facturaCobroQuery.getResultList();
          if (p.isEmpty()){
              btn_detalleCheque.setEnabled(false);
             montoCheque=0;
            tf_montoCheque.setText(String.valueOf(montoCheque));
        }
          else{
              btn_detalleCheque.setEnabled(true);
         facturaCobroQuery=entityManager.createNativeQuery("SELECT sum(fc.total)"+
                        "FROM factura_cobro fc "+
                        "JOIN detalle_cobro dc "+
                        "on dc.idDetalle=fc.forma_pago "+
                        "WHERE fc.tipoFactura='Crédito' "+
                        "and dc.forma='Cheque' "+
                        "AND STR_TO_DATE(fechaEmision , '%d/%m/%Y %H :%i :%s') "+
                        "BETWEEN STR_TO_DATE('"+f1+"', '%d/%m/%Y %H :%i :%s') "+
                        "AND STR_TO_DATE('"+f2+"', '%d/%m/%Y %H :%i :%s') "//+
                        //" GROUP BY dc.entidad"
                  );
                         Object resultado=facturaCobroQuery.getSingleResult();
                         montoCheque=Integer.parseInt(resultado.toString());
                          tf_montoCheque.setText(String.valueOf(montoCheque));
    }}
    



    public void vaciar(){
                    tf_caja.setText(null);
                    tf_fechaApertura.setText(null);
                    tf_fechaCierre.setText(null);
                    tf_montoCheque.setText(null);
                    tf_montoEfectivo.setText(null);
                    tf_montoTarjetaDebito.setText(null);
                    tf_montoTotal.setText(null);
                    tf_montoInicial.setText(null);
                   tf_montoTarjetaCredito.setText(null);
                     this.setVisible(false);
        String[] args = null;
                    MenuSupervisorCaja.main(args);
       
                    
 
    }

    private void buscarCuentaBancaria() {
   
         new CuentaBancBuscar(this, true).setVisible(true);
         System.out.print("cuenta"+cuentaBancaria);
    }
     private CuentaBancaria obtenerCuenta(int nro) {
            EntityManagerFactory fact = Persistence.createEntityManagerFactory("proyectoPU");
            EntityManager ema = fact.createEntityManager(); 
            Query bancoQuery;
            bancoQuery = ema.createNamedQuery("CuentaBancaria.findByIdCuentaBancaria");
            bancoQuery.setParameter("idCuentaBancaria", nro );
            CuentaBancaria cuentaLocal = null;
            try{
               cuentaLocal = (CuentaBancaria)bancoQuery.getSingleResult();
               System.out.println(cuentaLocal);
            }catch(javax.persistence.NoResultException e){
                System.out.println(cuentaLocal);
            }
            ema.close();
            return cuentaLocal;
}

    private void imprimir() {
         try
        {
            Class.forName("com.mysql.jdbc.Driver");
            Connection con = (Connection) DriverManager.getConnection("jdbc:mysql://localhost:3306/hotel db", "root", "1234");
          //  HashMap par = new HashMap();//no definimos ningún parámetro por eso lo dejamos así
            Map parametros=new HashMap();
            parametros.put("fecha",ArquearCaja.tf_fechaApertura.getText() );
            parametros.put("fechaFin",ArquearCaja.tf_fechaCierre.getText() );
           // parametros.put("formaPago","TarjetaDebito" );
            JasperPrint jp = JasperFillManager.fillReport("C:/Users/pc/Documents/NetBeansProjects/Proyecto-II/src/reportes/CobrosDelDia.jasper", parametros,con);//el primer parámetro es el camino del archivo, se cambia esta dirección por la dirección del archivo .jasper
            //C:/Users/pc/Documents/NetBeansProjects/Proyecto-II/src/reportes/CobrosDelDia.jasper
            //C:/proyecto/src
            JasperViewer jv = new JasperViewer(jp,false);
            jv.setVisible(true);//C:\Users\pc\Downloads\Proyect-II-master (2)\Proyect-II-master\src\reportes
            jv.setTitle("Detalle Cobro");
          //   Image icon = new ImageIcon(getClass().getResource("/imagenes/hotel2.png")).getImage();
          //   jv.setIconImage(icon);
            jv.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }
         }
    }
    
        
